-- lanza desde z39.50 (php de pmb) s√≥lo cuando no 
-- existe al registro 1, 'sujet', 21

DROP TABLE IF EXISTS `z_attr_bak`;
CREATE TABLE IF NOT EXISTS `z_attr_bak` (
  `attr_bib_id` int(6) unsigned NOT NULL DEFAULT '0',
  `attr_libelle` varchar(250) COLLATE utf8_unicode_ci NOT NULL DEFAULT '',
  `attr_attr` varchar(250) COLLATE utf8_unicode_ci DEFAULT NULL,
  PRIMARY KEY (`attr_bib_id`,`attr_libelle`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

-- Volcado de datos para la tabla `z_attr`
--

INSERT INTO `z_attr_bak` (`attr_bib_id`, `attr_libelle`, `attr_attr`) VALUES
(2, 'sujet', '21'),
(2, 'titre', '4'),
(2, 'auteur', '1003'),
(2, 'isbn', '7'),
(3, 'sujet', '21'),
(3, 'titre', '4'),
(3, 'isbn', '7'),
(3, 'auteur', '1003'),
(5, 'auteur', '1004'),
(5, 'titre', '4'),
(5, 'isbn', '7'),
(5, 'sujet', '21'),
(7, 'isbn', '7'),
(7, 'auteur', '1003'),
(7, 'titre', '4'),
(7, 'sujet', '21'),
(8, 'auteur', '1'),
(8, 'titre', '4'),
(8, 'isbn', '7'),
(8, 'sujet', '21'),
(10, 'auteur', '1003'),
(10, 'titre', '4'),
(10, 'isbn', '7'),
(10, 'sujet', '21'),
(12, 'sujet', '21'),
(12, 'auteur', '1003'),
(12, 'titre', '4'),
(12, 'isbn', '7'),
(11, 'sujet', '21'),
(11, 'auteur', '1003'),
(11, 'isbn', '7'),
(11, 'titre', '4'),
(15, 'auteur', '1003'),
(15, 'titre', '4'),
(15, 'isbn', '7'),
(15, 'sujet', '21'),
(17, 'sujet', '21'),
(17, 'auteur', '1003'),
(17, 'isbn', '7'),
(17, 'titre', '4'),
(21, 'sujet', '21'),
(21, 'auteur', '1003'),
(21, 'isbn', '7'),
(21, 'titre', '4'),
(1, 'auteur', '1003'),
(1, 'isbn', '7'),
(1, 'sujet', '21'),
(1, 'titre', '4'),
(4, 'auteur', '1003'),
(4, 'isbn', '7'),
(4, 'sujet', '21'),
(4, 'titre', '4'),
(6, 'auteur', '1003'),
(6, 'isbn', '7'),
(6, 'sujet', '21'),
(6, 'titre', '4'),
(9, 'auteur', '1003'),
(9, 'isbn', '7'),
(9, 'sujet', '21'),
(9, 'titre', '4'),
(13, 'auteur', '1003'),
(13, 'isbn', '7'),
(13, 'sujet', '21'),
(13, 'titre', '4'),
(14, 'auteur', '1003'),
(14, 'isbn', '7'),
(14, 'sujet', '21'),
(14, 'titre', '4'),
(16, 'auteur', '1003'),
(16, 'isbn', '7'),
(16, 'sujet', '21'),
(16, 'titre', '4'),
(18, 'auteur', '1003'),
(18, 'isbn', '7'),
(18, 'sujet', '21'),
(18, 'titre', '4'),
(19, 'auteur', '1003'),
(19, 'isbn', '7'),
(19, 'sujet', '21'),
(19, 'titre', '4'),
(20, 'auteur', '1003'),
(20, 'isbn', '7'),
(20, 'sujet', '21'),
(20, 'titre', '4'),
(22, 'auteur', '1003'),
(22, 'isbn', '7'),
(22, 'sujet', '21'),
(22, 'titre', '4'),
(23, 'auteur', '1003'),
(23, 'isbn', '7'),
(23, 'sujet', '21'),
(23, 'titre', '4'),
(24, 'auteur', '1003'),
(24, 'isbn', '7'),
(24, 'sujet', '21'),
(24, 'titre', '4'),
(25, 'auteur', '1003'),
(25, 'isbn', '7'),
(25, 'sujet', '21'),
(25, 'titre', '4'),
(26, 'auteur', '1003'),
(26, 'isbn', '7'),
(26, 'sujet', '21'),
(26, 'titre', '4'),
(27, 'auteur', '1003'),
(27, 'isbn', '7'),
(27, 'sujet', '21'),
(27, 'titre', '4'),
(28, 'auteur', '1003'),
(28, 'isbn', '7'),
(28, 'sujet', '21'),
(28, 'titre', '4'),
(29, 'auteur', '1003'),
(29, 'isbn', '7'),
(29, 'sujet', '21'),
(29, 'titre', '4'),
(30, 'auteur', '1003'),
(30, 'isbn', '7'),
(30, 'sujet', '21'),
(30, 'titre', '4'),
(31, 'auteur', '1003'),
(31, 'isbn', '7'),
(31, 'sujet', '21'),
(31, 'titre', '4'),
(32, 'auteur', '1003'),
(32, 'isbn', '7'),
(32, 'sujet', '21'),
(32, 'titre', '4'),
(33, 'auteur', '1003'),
(33, 'isbn', '7'),
(33, 'sujet', '21'),
(33, 'titre', '4'),
(34, 'auteur', '1003'),
(34, 'isbn', '7'),
(34, 'sujet', '21'),
(34, 'titre', '4'),
(35, 'auteur', '1003'),
(35, 'isbn', '7'),
(35, 'sujet', '21'),
(35, 'titre', '4'),
(36, 'auteur', '1003'),
(36, 'isbn', '7'),
(36, 'sujet', '21'),
(36, 'titre', '4'),
(37, 'auteur', '1003'),
(37, 'isbn', '7'),
(37, 'sujet', '21'),
(37, 'titre', '4'),
(38, 'auteur', '1003'),
(38, 'isbn', '7'),
(38, 'sujet', '21'),
(38, 'titre', '4');

INSERT INTO `z_attr`
SELECT DISTINCT A.attr_bib_id, A.attr_libelle, A.attr_attr
FROM `z_attr_bak` A
LEFT JOIN `z_attr` B
ON A.attr_bib_id = B.attr_bib_id and A.attr_libelle = B.attr_libelle
WHERE B.attr_bib_id IS NULL;


DROP TABLE IF EXISTS `z_attr_bak`;
